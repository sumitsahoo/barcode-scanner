function I(e,i,s,t){return new(s||(s=Promise))(function(u,_){function f(d){try{B(t.next(d))}catch(y){_(y)}}function R(d){try{B(t.throw(d))}catch(y){_(y)}}function B(d){var y;d.done?u(d.value):(y=d.value,y instanceof s?y:new s(function(l){l(y)})).then(f,R)}B((t=t.apply(e,[])).next())})}var W,pe=(W=import.meta.url,async function(e={}){var i,s,t=e;t.ready=new Promise((r,n)=>{i=r,s=n});var u,_,f,R=Object.assign({},t),B=typeof window=="object",d=typeof importScripts=="function",y=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",l="";if(y){const{createRequire:r}=await Promise.resolve().then(()=>Ze);var Z=r(import.meta.url),X=Z("fs"),H=Z("path");l=d?H.dirname(l)+"/":Z("url").fileURLToPath(new URL("/barcode-scanner/assets/index-BY-99T_0.mjs",import.meta.url)),u=(n,o)=>(n=T(n)?new URL(n):H.normalize(n),X.readFileSync(n,o?void 0:"utf8")),f=n=>{var o=u(n,!0);return o.buffer||(o=new Uint8Array(o)),o},_=(n,o,a,c=!0)=>{n=T(n)?new URL(n):H.normalize(n),X.readFile(n,c?void 0:"utf8",(h,A)=>{h?a(h):o(c?A.buffer:A)})},!t.thisProgram&&process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),t.inspect=()=>"[Emscripten Module object]"}else(B||d)&&(d?l=self.location.href:typeof document<"u"&&document.currentScript&&(l=document.currentScript.src),W&&(l=W),l=l.indexOf("blob:")!==0?l.substr(0,l.replace(/[?#].*/,"").lastIndexOf("/")+1):"",u=r=>{var n=new XMLHttpRequest;return n.open("GET",r,!1),n.send(null),n.responseText},d&&(f=r=>{var n=new XMLHttpRequest;return n.open("GET",r,!1),n.responseType="arraybuffer",n.send(null),new Uint8Array(n.response)}),_=(r,n,o)=>{var a=new XMLHttpRequest;a.open("GET",r,!0),a.responseType="arraybuffer",a.onload=()=>{a.status==200||a.status==0&&a.response?n(a.response):o()},a.onerror=o,a.send(null)});var S,w,m,fe=t.print||console.log.bind(console),b=t.printErr||console.error.bind(console);Object.assign(t,R),R=null,t.arguments&&t.arguments,t.thisProgram&&t.thisProgram,t.quit&&t.quit,t.wasmBinary&&(S=t.wasmBinary),t.noExitRuntime,typeof WebAssembly!="object"&&J("no native wasm support detected");var L,P,z=!1;function K(){var r=w.buffer;t.HEAP8=new Int8Array(r),t.HEAP16=new Int16Array(r),t.HEAP32=new Int32Array(r),t.HEAPU8=L=new Uint8Array(r),t.HEAPU16=new Uint16Array(r),t.HEAPU32=P=new Uint32Array(r),t.HEAPF32=new Float32Array(r),t.HEAPF64=new Float64Array(r)}var Q=[],$=[],V=[],v=0,N=null;function J(r){t.onAbort&&t.onAbort(r),b(r="Aborted("+r+")"),z=!0,r+=". Build with -sASSERTIONS for more info.";var n=new WebAssembly.RuntimeError(r);throw s(n),n}var C,M,he="data:application/octet-stream;base64,";function ee(r){return r.startsWith(he)}function T(r){return r.startsWith("file://")}function te(r){if(r==C&&S)return new Uint8Array(S);if(f)return f(r);throw"both async and sync fetching of the wasm failed"}function re(r,n,o){return function(a){if(!S&&(B||d)){if(typeof fetch=="function"&&!T(a))return fetch(a,{credentials:"same-origin"}).then(c=>{if(!c.ok)throw"failed to load wasm binary file at '"+a+"'";return c.arrayBuffer()}).catch(()=>te(a));if(_)return new Promise((c,h)=>{_(a,A=>c(new Uint8Array(A)),h)})}return Promise.resolve().then(()=>te(a))}(r).then(a=>WebAssembly.instantiate(a,n)).then(a=>a).then(o,a=>{b("failed to asynchronously prepare wasm: "+a),J(a)})}t.locateFile?ee(C="zbar.wasm")||(M=C,C=t.locateFile?t.locateFile(M,l):l+M):C=new URL("/barcode-scanner/assets/zbar-BSn7mpZR.wasm",import.meta.url).href;var O,x=r=>{for(;r.length>0;)r.shift()(t)},le=r=>{var n=r-w.buffer.byteLength+65535>>>16;try{return w.grow(n),K(),1}catch{}},ne=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Re=[null,[],[]],de=(r,n)=>{var o=Re[r];n===0||n===10?((r===1?fe:b)(((a,c,h)=>{for(var A=c+h,p=c;a[p]&&!(p>=A);)++p;if(p-c>16&&a.buffer&&ne)return ne.decode(a.subarray(c,p));for(var E="";c<p;){var g=a[c++];if(128&g){var D=63&a[c++];if((224&g)!=192){var F=63&a[c++];if((g=(240&g)==224?(15&g)<<12|D<<6|F:(7&g)<<18|D<<12|F<<6|63&a[c++])<65536)E+=String.fromCharCode(g);else{var ae=g-65536;E+=String.fromCharCode(55296|ae>>10,56320|1023&ae)}}else E+=String.fromCharCode((31&g)<<6|D)}else E+=String.fromCharCode(g)}return E})(o,0)),o.length=0):o.push(n)},me={d:()=>!0,e:function(){return Date.now()},c:r=>{var n=L.length,o=2147483648;if((r>>>=0)>o)return!1;for(var a,c,h=1;h<=4;h*=2){var A=n*(1+.2/h);A=Math.min(A,r+100663296);var p=Math.min(o,(a=Math.max(r,A))+((c=65536)-a%c)%c);if(le(p))return!0}return!1},f:r=>52,b:function(r,n,o,a,c){return 70},a:(r,n,o,a)=>{for(var c=0,h=0;h<o;h++){var A=P[n>>2],p=P[n+4>>2];n+=8;for(var E=0;E<p;E++)de(r,L[A+E]);c+=p}return P[a>>2]=c,0}};function ie(){function r(){O||(O=!0,t.calledRun=!0,z||(x($),i(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),function(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)n=t.postRun.shift(),V.unshift(n);var n;x(V)}()))}v>0||(function(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)n=t.preRun.shift(),Q.unshift(n);var n;x(Q)}(),v>0||(t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),r()},1)):r()))}if(function(){var r,n,o,a,c={a:me};function h(A,p){var E,g=A.exports;return w=(m=g).g,K(),m.s,E=m.h,$.unshift(E),function(D){if(v--,t.monitorRunDependencies&&t.monitorRunDependencies(v),v==0&&N){var F=N;N=null,F()}}(),g}if(v++,t.monitorRunDependencies&&t.monitorRunDependencies(v),t.instantiateWasm)try{return t.instantiateWasm(c,h)}catch(A){b("Module.instantiateWasm callback failed with error: "+A),s(A)}(r=S,n=C,o=c,a=function(A){h(A.instance)},r||typeof WebAssembly.instantiateStreaming!="function"||ee(n)||T(n)||y||typeof fetch!="function"?re(n,o,a):fetch(n,{credentials:"same-origin"}).then(A=>WebAssembly.instantiateStreaming(A,o).then(a,function(p){return b("wasm streaming compile failed: "+p),b("falling back to ArrayBuffer instantiation"),re(n,o,a)}))).catch(s)}(),t._ImageScanner_create=()=>(t._ImageScanner_create=m.i)(),t._ImageScanner_destory=r=>(t._ImageScanner_destory=m.j)(r),t._ImageScanner_set_config=(r,n,o,a)=>(t._ImageScanner_set_config=m.k)(r,n,o,a),t._ImageScanner_enable_cache=(r,n)=>(t._ImageScanner_enable_cache=m.l)(r,n),t._ImageScanner_recycle_image=(r,n)=>(t._ImageScanner_recycle_image=m.m)(r,n),t._ImageScanner_get_results=r=>(t._ImageScanner_get_results=m.n)(r),t._ImageScanner_scan=(r,n)=>(t._ImageScanner_scan=m.o)(r,n),t._Image_create=(r,n,o,a,c,h)=>(t._Image_create=m.p)(r,n,o,a,c,h),t._Image_destory=r=>(t._Image_destory=m.q)(r),t._Image_get_symbols=r=>(t._Image_get_symbols=m.r)(r),t._free=r=>(t._free=m.t)(r),t._malloc=r=>(t._malloc=m.u)(r),N=function r(){O||ie(),O||(N=r)},t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return ie(),e.ready});let k;function Be(e={}){k=function(){return I(this,void 0,void 0,function*(){const i=yield pe(e);if(i)return i;throw Error("WASM was not loaded")})}()}function Y(){return I(this,void 0,void 0,function*(){return k||Be(),yield k})}var U,j,se;(function(e){e[e.ZBAR_NONE=0]="ZBAR_NONE",e[e.ZBAR_PARTIAL=1]="ZBAR_PARTIAL",e[e.ZBAR_EAN2=2]="ZBAR_EAN2",e[e.ZBAR_EAN5=5]="ZBAR_EAN5",e[e.ZBAR_EAN8=8]="ZBAR_EAN8",e[e.ZBAR_UPCE=9]="ZBAR_UPCE",e[e.ZBAR_ISBN10=10]="ZBAR_ISBN10",e[e.ZBAR_UPCA=12]="ZBAR_UPCA",e[e.ZBAR_EAN13=13]="ZBAR_EAN13",e[e.ZBAR_ISBN13=14]="ZBAR_ISBN13",e[e.ZBAR_COMPOSITE=15]="ZBAR_COMPOSITE",e[e.ZBAR_I25=25]="ZBAR_I25",e[e.ZBAR_DATABAR=34]="ZBAR_DATABAR",e[e.ZBAR_DATABAR_EXP=35]="ZBAR_DATABAR_EXP",e[e.ZBAR_CODABAR=38]="ZBAR_CODABAR",e[e.ZBAR_CODE39=39]="ZBAR_CODE39",e[e.ZBAR_PDF417=57]="ZBAR_PDF417",e[e.ZBAR_QRCODE=64]="ZBAR_QRCODE",e[e.ZBAR_SQCODE=80]="ZBAR_SQCODE",e[e.ZBAR_CODE93=93]="ZBAR_CODE93",e[e.ZBAR_CODE128=128]="ZBAR_CODE128",e[e.ZBAR_SYMBOL=255]="ZBAR_SYMBOL",e[e.ZBAR_ADDON2=512]="ZBAR_ADDON2",e[e.ZBAR_ADDON5=1280]="ZBAR_ADDON5",e[e.ZBAR_ADDON=1792]="ZBAR_ADDON"})(U||(U={})),function(e){e[e.ZBAR_CFG_ENABLE=0]="ZBAR_CFG_ENABLE",e[e.ZBAR_CFG_ADD_CHECK=1]="ZBAR_CFG_ADD_CHECK",e[e.ZBAR_CFG_EMIT_CHECK=2]="ZBAR_CFG_EMIT_CHECK",e[e.ZBAR_CFG_ASCII=3]="ZBAR_CFG_ASCII",e[e.ZBAR_CFG_BINARY=4]="ZBAR_CFG_BINARY",e[e.ZBAR_CFG_NUM=5]="ZBAR_CFG_NUM",e[e.ZBAR_CFG_MIN_LEN=32]="ZBAR_CFG_MIN_LEN",e[e.ZBAR_CFG_MAX_LEN=33]="ZBAR_CFG_MAX_LEN",e[e.ZBAR_CFG_UNCERTAINTY=64]="ZBAR_CFG_UNCERTAINTY",e[e.ZBAR_CFG_POSITION=128]="ZBAR_CFG_POSITION",e[e.ZBAR_CFG_TEST_INVERTED=129]="ZBAR_CFG_TEST_INVERTED",e[e.ZBAR_CFG_X_DENSITY=256]="ZBAR_CFG_X_DENSITY",e[e.ZBAR_CFG_Y_DENSITY=257]="ZBAR_CFG_Y_DENSITY"}(j||(j={})),function(e){e[e.ZBAR_ORIENT_UNKNOWN=-1]="ZBAR_ORIENT_UNKNOWN",e[e.ZBAR_ORIENT_UP=0]="ZBAR_ORIENT_UP",e[e.ZBAR_ORIENT_RIGHT=1]="ZBAR_ORIENT_RIGHT",e[e.ZBAR_ORIENT_DOWN=2]="ZBAR_ORIENT_DOWN",e[e.ZBAR_ORIENT_LEFT=3]="ZBAR_ORIENT_LEFT"}(se||(se={}));class ce{constructor(i,s){this.ptr=i,this.inst=s}checkAlive(){if(!this.ptr)throw Error("Call after destroyed")}getPointer(){return this.checkAlive(),this.ptr}}class ue{constructor(i,s){this.ptr=i,this.ptr32=i>>2,this.buf=s,this.HEAP8=new Int8Array(s),this.HEAPU32=new Uint32Array(s),this.HEAP32=new Int32Array(s)}}class q extends ue{get type(){return this.HEAPU32[this.ptr32]}get data(){const i=this.HEAPU32[this.ptr32+4],s=this.HEAPU32[this.ptr32+5];return Int8Array.from(this.HEAP8.subarray(s,s+i))}get points(){const i=this.HEAPU32[this.ptr32+7],s=this.HEAPU32[this.ptr32+8]>>2,t=[];for(let u=0;u<i;++u){const _=this.HEAP32[s+2*u],f=this.HEAP32[s+2*u+1];t.push({x:_,y:f})}return t}get orientation(){return this.HEAP32[this.ptr32+9]}get next(){const i=this.HEAPU32[this.ptr32+11];return i?new q(i,this.buf):null}get time(){return this.HEAPU32[this.ptr32+13]}get cacheCount(){return this.HEAP32[this.ptr32+14]}get quality(){return this.HEAP32[this.ptr32+15]}}class ye extends ue{get head(){const i=this.HEAPU32[this.ptr32+2];return i?new q(i,this.buf):null}}class G{constructor(i){this.type=i.type,this.typeName=U[this.type],this.data=i.data,this.points=i.points,this.orientation=i.orientation,this.time=i.time,this.cacheCount=i.cacheCount,this.quality=i.quality}static createSymbolsFromPtr(i,s){if(i==0)return[];let t=new ye(i,s).head;const u=[];for(;t!==null;)u.push(new G(t)),t=t.next;return u}decode(i){return new TextDecoder(i).decode(this.data)}}class _e extends ce{static createFromGrayBuffer(i,s,t,u=0){return I(this,void 0,void 0,function*(){const _=yield Y(),f=new Uint8Array(t),R=i*s;if(R!==f.byteLength)throw Error(`data length (${f.byteLength} bytes) does not match width and height (${R} bytes)`);const B=_._malloc(R);return _.HEAPU8.set(f,B),new this(_._Image_create(i,s,808466521,B,R,u),_)})}static createFromRGBABuffer(i,s,t,u=0){return I(this,void 0,void 0,function*(){const _=yield Y(),f=new Uint8Array(t),R=i*s;if(4*R!==f.byteLength)throw Error(`data length (${f.byteLength} bytes) does not match width and height (${4*R} bytes)`);const B=_._malloc(R),d=B+R,y=_.HEAPU8;for(let l=B,Z=0;l<d;l++,Z+=4)y[l]=19595*f[Z]+38469*f[Z+1]+7472*f[Z+2]>>16;return new this(_._Image_create(i,s,808466521,B,R,u),_)})}destroy(){this.checkAlive(),this.inst._Image_destory(this.ptr),this.ptr=0}getSymbols(){this.checkAlive();const i=this.inst._Image_get_symbols(this.ptr);return G.createSymbolsFromPtr(i,this.inst.HEAPU8.buffer)}}class ge extends ce{static create(){return I(this,void 0,void 0,function*(){const i=yield Y();return new this(i._ImageScanner_create(),i)})}destroy(){this.checkAlive(),this.inst._ImageScanner_destory(this.ptr),this.ptr=0}setConfig(i,s,t){return this.checkAlive(),this.inst._ImageScanner_set_config(this.ptr,i,s,t)}enableCache(i=!0){this.checkAlive(),this.inst._ImageScanner_enable_cache(this.ptr,i)}recycleImage(i){this.checkAlive(),this.inst._ImageScanner_recycle_image(this.ptr,i.getPointer())}getResults(){this.checkAlive();const i=this.inst._ImageScanner_get_results(this.ptr);return G.createSymbolsFromPtr(i,this.inst.HEAPU8.buffer)}scan(i){return this.checkAlive(),this.inst._ImageScanner_scan(this.ptr,i.getPointer())}}const Ee=()=>I(void 0,void 0,void 0,function*(){const e=yield ge.create();return e.setConfig(U.ZBAR_NONE,j.ZBAR_CFG_BINARY,1),e});let oe;const Ae=(e,i)=>I(void 0,void 0,void 0,function*(){i===void 0&&(i=oe||(yield Ee()),oe=i);const s=i.scan(e);if(s<0)throw Error("Scan Failed");return s===0?[]:e.getSymbols()}),ve=(e,i,s,t)=>I(void 0,void 0,void 0,function*(){const u=yield _e.createFromGrayBuffer(i,s,e),_=yield Ae(u,t);return u.destroy(),_}),Ie=(e,i,s,t)=>I(void 0,void 0,void 0,function*(){const u=yield _e.createFromRGBABuffer(i,s,e),_=yield Ae(u,t);return u.destroy(),_}),be=(e,i)=>I(void 0,void 0,void 0,function*(){return yield Ie(e.data.buffer,e.width,e.height,i)}),Ze=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{j as ZBarConfigType,_e as ZBarImage,se as ZBarOrientation,ge as ZBarScanner,G as ZBarSymbol,U as ZBarSymbolType,Ee as getDefaultScanner,Y as getInstance,ve as scanGrayBuffer,be as scanImageData,Ie as scanRGBABuffer,Be as setModuleArgs};
