!function(){"use strict";function e(e,t,n,r){return new(n||(n=Promise))(function(t,i){function s(e){try{o(r.next(e))}catch(t){i(t)}}function a(e){try{o(r.throw(e))}catch(t){i(t)}}function o(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n(function(e){e(r)})).then(s,a)}o((r=r.apply(e,[])).next())})}"function"==typeof SuppressedError&&SuppressedError;var t,n=(t=self.location.href,async function(e={}){var n,r,i=e;i.ready=new Promise((e,t)=>{n=e,r=t});var s,a,o,c=Object.assign({},i),_="object"==typeof window,u="function"==typeof importScripts,A="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,f="";if(A){const{createRequire:e}=await Promise.resolve().then(()=>y);var h=e(self.location.href),l=h("fs"),R=h("path");f=u?R.dirname(f)+"/":h("url").fileURLToPath(new URL("/barcode-scanner/assets/index-BY-99T_0.mjs",self.location.href)),s=(e,t)=>(e=F(e)?new URL(e):R.normalize(e),l.readFileSync(e,t?void 0:"utf8")),o=e=>{var t=s(e,!0);return t.buffer||(t=new Uint8Array(t)),t},a=(e,t,n,r=!0)=>{e=F(e)?new URL(e):R.normalize(e),l.readFile(e,r?void 0:"utf8",(e,i)=>{e?n(e):t(r?i.buffer:i)})},!i.thisProgram&&process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),i.inspect=()=>"[Emscripten Module object]"}else(_||u)&&(u?f=self.location.href:"undefined"!=typeof document&&document.currentScript&&(f=document.currentScript.src),t&&(f=t),f=0!==f.indexOf("blob:")?f.substr(0,f.replace(/[?#].*/,"").lastIndexOf("/")+1):"",s=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},u&&(o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),a=(e,t,n)=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)});var d,p,m,B=i.print||function(){}.bind(),g=i.printErr||function(){}.bind();Object.assign(i,c),c=null,i.arguments&&i.arguments,i.thisProgram&&i.thisProgram,i.quit&&i.quit,i.wasmBinary&&(d=i.wasmBinary),i.noExitRuntime,"object"!=typeof WebAssembly&&P("no native wasm support detected");var E,I,Z=!1;function v(){var e=p.buffer;i.HEAP8=new Int8Array(e),i.HEAP16=new Int16Array(e),i.HEAP32=new Int32Array(e),i.HEAPU8=E=new Uint8Array(e),i.HEAPU16=new Uint16Array(e),i.HEAPU32=I=new Uint32Array(e),i.HEAPF32=new Float32Array(e),i.HEAPF64=new Float64Array(e)}var b=[],C=[],N=[],S=0,w=null;function P(e){i.onAbort&&i.onAbort(e),g(e="Aborted("+e+")"),Z=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw r(t),t}var T,D;function O(e){return e.startsWith("data:application/octet-stream;base64,")}function F(e){return e.startsWith("file://")}function U(e){if(e==T&&d)return new Uint8Array(d);if(o)return o(e);throw"both async and sync fetching of the wasm failed"}function H(e,t,n){return function(e){if(!d&&(_||u)){if("function"==typeof fetch&&!F(e))return fetch(e,{credentials:"same-origin"}).then(t=>{if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()}).catch(()=>U(e));if(a)return new Promise((t,n)=>{a(e,e=>t(new Uint8Array(e)),n)})}return Promise.resolve().then(()=>U(e))}(e).then(e=>WebAssembly.instantiate(e,t)).then(e=>e).then(n,e=>{g("failed to asynchronously prepare wasm: "+e),P(e)})}i.locateFile?O(T="zbar.wasm")||(D=T,T=i.locateFile?i.locateFile(D,f):f+D):T=new URL("/barcode-scanner/assets/zbar-BSn7mpZR.wasm",self.location.href).href;var G,L=e=>{for(;e.length>0;)e.shift()(i)},M=e=>{var t=e-p.buffer.byteLength+65535>>>16;try{return p.grow(t),v(),1}catch(n){}},x="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,W=[null,[],[]],k=(e,t)=>{var n=W[e];0===t||10===t?((1===e?B:g)(((e,t)=>{for(var n=t+void 0,r=t;e[r]&&!(r>=n);)++r;if(r-t>16&&e.buffer&&x)return x.decode(e.subarray(t,r));for(var i="";t<r;){var s=e[t++];if(128&s){var a=63&e[t++];if(192!=(224&s)){var o=63&e[t++];if((s=224==(240&s)?(15&s)<<12|a<<6|o:(7&s)<<18|a<<12|o<<6|63&e[t++])<65536)i+=String.fromCharCode(s);else{var c=s-65536;i+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else i+=String.fromCharCode((31&s)<<6|a)}else i+=String.fromCharCode(s)}return i})(n,0)),n.length=0):n.push(t)},Y={d:()=>!0,e:function(){return Date.now()},c:e=>{var t=E.length,n=2147483648;if((e>>>=0)>n)return!1;for(var r,i=1;i<=4;i*=2){var s=t*(1+.2/i);s=Math.min(s,e+100663296);var a=Math.min(n,(r=Math.max(e,s))+(65536-r%65536)%65536);if(M(a))return!0}return!1},f:e=>52,b:function(e,t,n,r,i){return 70},a:(e,t,n,r)=>{for(var i=0,s=0;s<n;s++){var a=I[t>>2],o=I[t+4>>2];t+=8;for(var c=0;c<o;c++)k(e,E[a+c]);i+=o}return I[r>>2]=i,0}};function j(){function e(){G||(G=!0,i.calledRun=!0,Z||(L(C),n(i),i.onRuntimeInitialized&&i.onRuntimeInitialized(),function(){if(i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;)e=i.postRun.shift(),N.unshift(e);var e;L(N)}()))}S>0||(function(){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)e=i.preRun.shift(),b.unshift(e);var e;L(b)}(),S>0||(i.setStatus?(i.setStatus("Running..."),setTimeout(function(){setTimeout(function(){i.setStatus("")},1),e()},1)):e()))}if(function(){var e,t,n,s,a={a:Y};function o(e,t){var n,r=e.exports;return p=(m=r).g,v(),m.s,n=m.h,C.unshift(n),function(){if(S--,i.monitorRunDependencies&&i.monitorRunDependencies(S),0==S&&w){var e=w;w=null,e()}}(),r}if(S++,i.monitorRunDependencies&&i.monitorRunDependencies(S),i.instantiateWasm)try{return i.instantiateWasm(a,o)}catch(c){g("Module.instantiateWasm callback failed with error: "+c),r(c)}(e=d,t=T,n=a,s=function(e){o(e.instance)},e||"function"!=typeof WebAssembly.instantiateStreaming||O(t)||F(t)||A||"function"!=typeof fetch?H(t,n,s):fetch(t,{credentials:"same-origin"}).then(e=>WebAssembly.instantiateStreaming(e,n).then(s,function(e){return g("wasm streaming compile failed: "+e),g("falling back to ArrayBuffer instantiation"),H(t,n,s)}))).catch(r)}(),i._ImageScanner_create=()=>(i._ImageScanner_create=m.i)(),i._ImageScanner_destory=e=>(i._ImageScanner_destory=m.j)(e),i._ImageScanner_set_config=(e,t,n,r)=>(i._ImageScanner_set_config=m.k)(e,t,n,r),i._ImageScanner_enable_cache=(e,t)=>(i._ImageScanner_enable_cache=m.l)(e,t),i._ImageScanner_recycle_image=(e,t)=>(i._ImageScanner_recycle_image=m.m)(e,t),i._ImageScanner_get_results=e=>(i._ImageScanner_get_results=m.n)(e),i._ImageScanner_scan=(e,t)=>(i._ImageScanner_scan=m.o)(e,t),i._Image_create=(e,t,n,r,s,a)=>(i._Image_create=m.p)(e,t,n,r,s,a),i._Image_destory=e=>(i._Image_destory=m.q)(e),i._Image_get_symbols=e=>(i._Image_get_symbols=m.r)(e),i._free=e=>(i._free=m.t)(e),i._malloc=e=>(i._malloc=m.u)(e),w=function e(){G||j(),G||(w=e)},i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();return j(),e.ready});let r;function i(){return e(this,0,void 0,function*(){return r||function(t={}){r=function(){return e(this,0,void 0,function*(){const e=yield n(t);if(e)return e;throw Error("WASM was not loaded")})}()}(),yield r})}var s,a,o,c;(c=s||(s={}))[c.ZBAR_NONE=0]="ZBAR_NONE",c[c.ZBAR_PARTIAL=1]="ZBAR_PARTIAL",c[c.ZBAR_EAN2=2]="ZBAR_EAN2",c[c.ZBAR_EAN5=5]="ZBAR_EAN5",c[c.ZBAR_EAN8=8]="ZBAR_EAN8",c[c.ZBAR_UPCE=9]="ZBAR_UPCE",c[c.ZBAR_ISBN10=10]="ZBAR_ISBN10",c[c.ZBAR_UPCA=12]="ZBAR_UPCA",c[c.ZBAR_EAN13=13]="ZBAR_EAN13",c[c.ZBAR_ISBN13=14]="ZBAR_ISBN13",c[c.ZBAR_COMPOSITE=15]="ZBAR_COMPOSITE",c[c.ZBAR_I25=25]="ZBAR_I25",c[c.ZBAR_DATABAR=34]="ZBAR_DATABAR",c[c.ZBAR_DATABAR_EXP=35]="ZBAR_DATABAR_EXP",c[c.ZBAR_CODABAR=38]="ZBAR_CODABAR",c[c.ZBAR_CODE39=39]="ZBAR_CODE39",c[c.ZBAR_PDF417=57]="ZBAR_PDF417",c[c.ZBAR_QRCODE=64]="ZBAR_QRCODE",c[c.ZBAR_SQCODE=80]="ZBAR_SQCODE",c[c.ZBAR_CODE93=93]="ZBAR_CODE93",c[c.ZBAR_CODE128=128]="ZBAR_CODE128",c[c.ZBAR_SYMBOL=255]="ZBAR_SYMBOL",c[c.ZBAR_ADDON2=512]="ZBAR_ADDON2",c[c.ZBAR_ADDON5=1280]="ZBAR_ADDON5",c[c.ZBAR_ADDON=1792]="ZBAR_ADDON",function(e){e[e.ZBAR_CFG_ENABLE=0]="ZBAR_CFG_ENABLE",e[e.ZBAR_CFG_ADD_CHECK=1]="ZBAR_CFG_ADD_CHECK",e[e.ZBAR_CFG_EMIT_CHECK=2]="ZBAR_CFG_EMIT_CHECK",e[e.ZBAR_CFG_ASCII=3]="ZBAR_CFG_ASCII",e[e.ZBAR_CFG_BINARY=4]="ZBAR_CFG_BINARY",e[e.ZBAR_CFG_NUM=5]="ZBAR_CFG_NUM",e[e.ZBAR_CFG_MIN_LEN=32]="ZBAR_CFG_MIN_LEN",e[e.ZBAR_CFG_MAX_LEN=33]="ZBAR_CFG_MAX_LEN",e[e.ZBAR_CFG_UNCERTAINTY=64]="ZBAR_CFG_UNCERTAINTY",e[e.ZBAR_CFG_POSITION=128]="ZBAR_CFG_POSITION",e[e.ZBAR_CFG_TEST_INVERTED=129]="ZBAR_CFG_TEST_INVERTED",e[e.ZBAR_CFG_X_DENSITY=256]="ZBAR_CFG_X_DENSITY",e[e.ZBAR_CFG_Y_DENSITY=257]="ZBAR_CFG_Y_DENSITY"}(a||(a={})),function(e){e[e.ZBAR_ORIENT_UNKNOWN=-1]="ZBAR_ORIENT_UNKNOWN",e[e.ZBAR_ORIENT_UP=0]="ZBAR_ORIENT_UP",e[e.ZBAR_ORIENT_RIGHT=1]="ZBAR_ORIENT_RIGHT",e[e.ZBAR_ORIENT_DOWN=2]="ZBAR_ORIENT_DOWN",e[e.ZBAR_ORIENT_LEFT=3]="ZBAR_ORIENT_LEFT"}(o||(o={}));class _{constructor(e,t){this.ptr=e,this.inst=t}checkAlive(){if(!this.ptr)throw Error("Call after destroyed")}getPointer(){return this.checkAlive(),this.ptr}}class u{constructor(e,t){this.ptr=e,this.ptr32=e>>2,this.buf=t,this.HEAP8=new Int8Array(t),this.HEAPU32=new Uint32Array(t),this.HEAP32=new Int32Array(t)}}class A extends u{get type(){return this.HEAPU32[this.ptr32]}get data(){const e=this.HEAPU32[this.ptr32+4],t=this.HEAPU32[this.ptr32+5];return Int8Array.from(this.HEAP8.subarray(t,t+e))}get points(){const e=this.HEAPU32[this.ptr32+7],t=this.HEAPU32[this.ptr32+8]>>2,n=[];for(let r=0;r<e;++r){const e=this.HEAP32[t+2*r],i=this.HEAP32[t+2*r+1];n.push({x:e,y:i})}return n}get orientation(){return this.HEAP32[this.ptr32+9]}get next(){const e=this.HEAPU32[this.ptr32+11];return e?new A(e,this.buf):null}get time(){return this.HEAPU32[this.ptr32+13]}get cacheCount(){return this.HEAP32[this.ptr32+14]}get quality(){return this.HEAP32[this.ptr32+15]}}class f extends u{get head(){const e=this.HEAPU32[this.ptr32+2];return e?new A(e,this.buf):null}}class h{constructor(e){this.type=e.type,this.typeName=s[this.type],this.data=e.data,this.points=e.points,this.orientation=e.orientation,this.time=e.time,this.cacheCount=e.cacheCount,this.quality=e.quality}static createSymbolsFromPtr(e,t){if(0==e)return[];let n=new f(e,t).head;const r=[];for(;null!==n;)r.push(new h(n)),n=n.next;return r}decode(e){return new TextDecoder(e).decode(this.data)}}class l extends _{static createFromGrayBuffer(t,n,r,s=0){return e(this,0,void 0,function*(){const e=yield i(),a=new Uint8Array(r),o=t*n;if(o!==a.byteLength)throw Error(`data length (${a.byteLength} bytes) does not match width and height (${o} bytes)`);const c=e._malloc(o);return e.HEAPU8.set(a,c),new this(e._Image_create(t,n,808466521,c,o,s),e)})}static createFromRGBABuffer(t,n,r,s=0){return e(this,0,void 0,function*(){const e=yield i(),a=new Uint8Array(r),o=t*n;if(4*o!==a.byteLength)throw Error(`data length (${a.byteLength} bytes) does not match width and height (${4*o} bytes)`);const c=e._malloc(o),_=c+o,u=e.HEAPU8;for(let t=c,n=0;t<_;t++,n+=4)u[t]=19595*a[n]+38469*a[n+1]+7472*a[n+2]>>16;return new this(e._Image_create(t,n,808466521,c,o,s),e)})}destroy(){this.checkAlive(),this.inst._Image_destory(this.ptr),this.ptr=0}getSymbols(){this.checkAlive();const e=this.inst._Image_get_symbols(this.ptr);return h.createSymbolsFromPtr(e,this.inst.HEAPU8.buffer)}}class R extends _{static create(){return e(this,0,void 0,function*(){const e=yield i();return new this(e._ImageScanner_create(),e)})}destroy(){this.checkAlive(),this.inst._ImageScanner_destory(this.ptr),this.ptr=0}setConfig(e,t,n){return this.checkAlive(),this.inst._ImageScanner_set_config(this.ptr,e,t,n)}enableCache(e=!0){this.checkAlive(),this.inst._ImageScanner_enable_cache(this.ptr,e)}recycleImage(e){this.checkAlive(),this.inst._ImageScanner_recycle_image(this.ptr,e.getPointer())}getResults(){this.checkAlive();const e=this.inst._ImageScanner_get_results(this.ptr);return h.createSymbolsFromPtr(e,this.inst.HEAPU8.buffer)}scan(e){return this.checkAlive(),this.inst._ImageScanner_scan(this.ptr,e.getPointer())}}let d;const p=(t,n)=>e(void 0,0,void 0,function*(){void 0===n&&(n=d||(yield e(void 0,0,void 0,function*(){const e=yield R.create();return e.setConfig(s.ZBAR_NONE,a.ZBAR_CFG_BINARY,1),e})),d=n);const r=n.scan(t);if(r<0)throw Error("Scan Failed");return 0===r?[]:t.getSymbols()}),m=(t,n)=>e(void 0,0,void 0,function*(){return yield((t,n,r,i)=>e(void 0,0,void 0,function*(){const e=yield l.createFromRGBABuffer(n,r,t),s=yield p(e,i);return e.destroy(),s}))(t.data.buffer,t.width,t.height,n)}),y=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));self.onmessage=async e=>{const{imageData:t,type:n,sessionId:r}=e.data;if("scan"===n)try{const e=(e=>{const t=e.data,n=t.length;for(let r=0;r<n;r+=4){const e=77*t[r]+150*t[r+1]+29*t[r+2]>>8;t[r]=e,t[r+1]=e,t[r+2]=e}return e})(t),n=await m(e);if(n.length>0){const e=n[0];self.postMessage({found:!0,sessionId:r,data:{typeName:e.typeName?.replace("ZBAR_","")??"",scanData:e.decode()??""}})}else self.postMessage({found:!1,sessionId:r})}catch(i){self.postMessage({found:!1,sessionId:r,error:i.message})}}}();
